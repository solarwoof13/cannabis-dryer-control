<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=1024, height=600, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html, body {
            width: 1024px;
            height: 600px;
            overflow: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            position: relative;
            user-select: none;
        }

        /* TOP BAR - Reduced to 30px */
        .top-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(to bottom, rgba(30, 30, 30, 0.95), rgba(20, 20, 20, 0.9));
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 12px;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .wifi-layout {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .wifi-signal svg {
            width: 18px;
            height: 18px;
        }

        .wifi-status {
            color: #00C310;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .clock-layout {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .current-time {
            color: white;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        .current-date {
            color: rgba(255, 255, 255, 0.6);
            font-size: 9px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .system-status {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00C310;
            box-shadow: 0 0 6px #00C310;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            color: rgba(255, 255, 255, 0.7);
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* NAVIGATION BAR - Reduced to 35px */
        .nav-bar {
            position: absolute;
            top: 35px;
            left: 8px;
            right: 8px;
            height: 35px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 900;
        }

        .nav-buttons {
            display: flex;
            gap: 6px;
        }

        .nav-button {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.1), rgba(102, 51, 187, 0.1));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(136, 88, 237, 0.3);
            border-radius: 8px;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .nav-button:hover {
            transform: translateY(-1px);
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.2), rgba(102, 51, 187, 0.2));
            box-shadow: 0 4px 10px rgba(136, 88, 237, 0.3);
        }

        .nav-button.active {
            background: linear-gradient(135deg, #8858ed, #6633bb);
            border-color: #8858ed;
        }

        .nav-button svg {
            width: 16px;
            height: 16px;
            color: white;
        }

        .nav-button span {
            color: white;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        .emergency-button {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.2), rgba(204, 0, 0, 0.1));
            border: 1px solid rgba(255, 0, 0, 0.4);
        }

        .emergency-button:hover {
            background: linear-gradient(135deg, #FF4444, #CC0000);
            box-shadow: 0 4px 10px rgba(255, 0, 0, 0.4);
        }

        /* MAIN CONTAINER - Adjusted for screen size */
        .main-container {
            position: absolute;
            top: 75px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            display: grid;
            grid-template-columns: 0.9fr 1.1fr 0.9fr;
            gap: 10px;
            height: 517px; /* 600 - 75 (top) - 8 (bottom) */
        }

        /* LEFT PANEL - SENSORS */
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sensor-card {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.1), rgba(102, 51, 187, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid rgba(136, 88, 237, 0.2);
            padding: 12px;
            transition: all 0.3s ease;
        }

        .sensor-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(136, 88, 237, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-title {
            color: white;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sensor-status {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00C310;
            box-shadow: 0 0 6px #00C310;
        }

        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .sensor-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sensor-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            margin-bottom: 4px;
        }

        .sensor-values-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sensor-value {
            color: white;
            font-size: 18px;
            font-weight: 800;
        }

        .sensor-humidity {
            color: #4A90E2;
            font-size: 18px;
            font-weight: 800;
        }

        .sensor-unit {
            color: #8858ed;
            font-size: 10px;
            font-weight: 600;
            margin-left: 2px;
        }

        .sensor-unit-humid {
            color: #4A90E2;
            font-size: 10px;
            font-weight: 600;
            margin-left: 2px;
        }

        /* CENTER PANEL - VPD */
        .center-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .vpd-main-card {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.15), rgba(102, 51, 187, 0.1));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(136, 88, 237, 0.3);
            padding: 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            height: 330px;
        }

        .mode-indicator {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 6px 15px;
            border: 1px solid rgba(136, 88, 237, 0.3);
        }

        .mode-text {
            color: white;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mode-progress {
            color: #8858ed;
            font-size: 9px;
            font-weight: 600;
            text-align: center;
            margin-top: 2px;
        }

        .vpd-display {
            text-align: center;
            margin: 25px 0;
        }

        .vpd-large-value {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, #8858ed, #6633bb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(136, 88, 237, 0.3);
        }

        .vpd-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 8px;
        }

        .vpd-range {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding: 10px 18px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }

        .range-label {
            color: rgba(255, 255, 255, 0.5);
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .range-value {
            color: #00C310;
            font-size: 15px;
            font-weight: 700;
        }

        .vpd-gauge-simple {
            width: 100%;
            max-width: 260px;
            height: 18px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 9px;
            overflow: hidden;
            position: relative;
            margin-top: 20px;
        }

        .gauge-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF4444, #FFA500, #FFFF00, #00C310, #00E515);
            width: 100%;
            position: relative;
        }

        .gauge-indicator {
            position: absolute;
            top: -3px;
            width: 4px;
            height: 24px;
            background: white;
            border-radius: 2px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            transition: left 0.5s ease;
        }

        .adjust-button {
            margin-top: 20px;
            padding: 10px 25px;
            background: linear-gradient(135deg, #8858ed, #6633bb);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(136, 88, 237, 0.3);
        }

        .adjust-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(136, 88, 237, 0.4);
        }

        /* PROCESS STATUS */
        .process-status-card {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.1), rgba(102, 51, 187, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid rgba(136, 88, 237, 0.2);
            padding: 15px;
            width: 100%;
            height: 167px;
        }

        .status-phase {
            margin-bottom: 15px;
        }

        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .phase-name {
            color: white;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .phase-time {
            color: #8858ed;
            font-size: 10px;
            font-weight: 600;
        }

        .phase-bar {
            height: 24px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .phase-fill {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: width 0.5s ease;
        }

        .phase-fill.complete {
            background: linear-gradient(90deg, #00C310, #00E515);
            width: 100%;
        }

        .phase-fill.active {
            background: linear-gradient(90deg, #8858ed, #6633bb);
        }

        .phase-text {
            color: white;
            font-size: 10px;
            font-weight: 700;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* RIGHT PANEL */
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* EQUIPMENT STATUS */
        .equipment-card {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.1), rgba(102, 51, 187, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid rgba(136, 88, 237, 0.2);
            padding: 12px;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .equipment-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .equipment-item:hover {
            transform: translateY(-1px);
            border-color: rgba(136, 88, 237, 0.3);
        }

        .equipment-name {
            color: rgba(255, 255, 255, 0.7);
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 5px;
        }

        .equipment-status-text {
            color: white;
            font-size: 11px;
            font-weight: 700;
        }

        .equipment-item.on {
            background: linear-gradient(135deg, rgba(0, 195, 16, 0.2), rgba(0, 227, 21, 0.1));
            border-color: rgba(0, 195, 16, 0.4);
        }

        .equipment-item.idle {
            background: linear-gradient(135deg, rgba(255, 165, 0, 0.2), rgba(255, 140, 0, 0.1));
            border-color: rgba(255, 165, 0, 0.4);
        }

        .equipment-item.off {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.2), rgba(204, 0, 0, 0.1));
            border-color: rgba(255, 68, 68, 0.4);
        }

        /* ALERTS */
        .alerts-card {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(204, 0, 0, 0.05));
            border: 1px solid rgba(255, 68, 68, 0.2);
        }

        .alert-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 8px;
            margin-bottom: 8px;
            border-left: 3px solid #FF4444;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .alert-icon {
            width: 14px;
            height: 14px;
            color: #FF4444;
        }

        .alert-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 10px;
            font-weight: 500;
            flex: 1;
        }

        .alert-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 9px;
        }

        /* ROOM SUMMARY */
        .room-summary {
            background: linear-gradient(135deg, rgba(136, 88, 237, 0.1), rgba(102, 51, 187, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid rgba(136, 88, 237, 0.2);
            padding: 12px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .summary-item {
            text-align: center;
        }

        .summary-value {
            color: white;
            font-size: 20px;
            font-weight: 800;
        }

        .summary-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <!-- TOP BAR -->
    <div class="top-bar">
        <div class="wifi-layout">
            <div class="wifi-signal">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 12.55a11 11 0 0 1 14.08 0" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M1.42 9a16 16 0 0 1 21.16 0" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
                    <path d="M8.53 16.11a6 6 0 0 1 6.95 0" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="12" y1="20" x2="12.01" y2="20" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="wifi-status">CONNECTED</div>
        </div>
        <div class="clock-layout">
            <div class="current-time" id="currentTime">2:45 PM</div>
            <div class="current-date" id="currentDate">DEC 20, 2024</div>
        </div>
        <div class="system-status">
            <div class="status-dot"></div>
            <div class="status-text">System Active</div>
        </div>
    </div>

    <!-- NAVIGATION BAR -->
    <div class="nav-bar">
        <div class="nav-buttons">
            <button class="nav-button active" onclick="goHome()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9,22 9,12 15,12 15,22"/>
                </svg>
                <span>Home</span>
            </button>
            <button class="nav-button" onclick="openSettings()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m5.7-5.7L11 11l-4.3 4.3m0-8.6L11 11l4.3-4.3"/>
                </svg>
                <span>Settings</span>
            </button>
            <button class="nav-button" onclick="openAnalytics()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"/>
                    <line x1="12" y1="20" x2="12" y2="4"/>
                    <line x1="6" y1="20" x2="6" y2="14"/>
                </svg>
                <span>Analytics</span>
            </button>
        </div>
        <button class="nav-button emergency-button" onclick="emergencyStop()">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <rect x="4" y="4" width="16" height="16" rx="2"/>
            </svg>
            <span>EMERGENCY STOP</span>
        </button>
    </div>

    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <!-- LEFT PANEL - SENSORS -->
        <div class="left-panel">
            <div class="sensor-card">
                <div class="card-header">
                    <div class="card-title">Zone Sensors</div>
                    <div class="sensor-status"></div>
                </div>
                <div class="sensor-grid">
                    <div class="sensor-item">
                        <div class="sensor-label">Zone 1</div>
                        <div class="sensor-values-row">
                            <div class="sensor-value" data-sensor="zone1-temp">72<span class="sensor-unit">°F</span></div>
                            <div class="sensor-humidity" data-sensor="zone1-humid">55<span class="sensor-unit-humid">%</span></div>
                        </div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Zone 2</div>
                        <div class="sensor-values-row">
                            <div class="sensor-value" data-sensor="zone2-temp">73<span class="sensor-unit">°F</span></div>
                            <div class="sensor-humidity" data-sensor="zone2-humid">54<span class="sensor-unit-humid">%</span></div>
                        </div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Zone 3</div>
                        <div class="sensor-values-row">
                            <div class="sensor-value" data-sensor="zone3-temp">71<span class="sensor-unit">°F</span></div>
                            <div class="sensor-humidity" data-sensor="zone3-humid">56<span class="sensor-unit-humid">%</span></div>
                        </div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Zone 4</div>
                        <div class="sensor-values-row">
                            <div class="sensor-value" data-sensor="zone4-temp">72<span class="sensor-unit">°F</span></div>
                            <div class="sensor-humidity" data-sensor="zone4-humid">55<span class="sensor-unit-humid">%</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sensor-card">
                <div class="card-header">
                    <div class="card-title">Air Control</div>
                    <div class="sensor-status"></div>
                </div>
                <div class="sensor-grid">
                    <div class="sensor-item">
                        <div class="sensor-label">Supply</div>
                        <div class="sensor-value" data-sensor="supply">70<span class="sensor-unit">°F</span></div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Return</div>
                        <div class="sensor-value" data-sensor="return">73<span class="sensor-unit">°F</span></div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Supply RH</div>
                        <div class="sensor-value" data-sensor="supply-rh">52<span class="sensor-unit">%</span></div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Return RH</div>
                        <div class="sensor-value" data-sensor="return-rh">58<span class="sensor-unit">%</span></div>
                    </div>
                </div>
            </div>

            <div class="room-summary">
                <div class="card-header">
                    <div class="card-title">Room Averages</div>
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-value">72°F</div>
                        <div class="summary-label">Temperature</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">55%</div>
                        <div class="summary-label">Humidity</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">54°F</div>
                        <div class="summary-label">Dew Point</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">0.58</div>
                        <div class="summary-label">Water Activity</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CENTER PANEL - VPD -->
        <div class="center-panel">
            <div class="vpd-main-card">
                <div class="mode-indicator">
                    <div class="mode-text" id="modeText">CURE MODE</div>
                    <div class="mode-progress" id="modeProgress">Day 2 of 4</div>
                </div>

                <div class="vpd-display">
                    <div class="vpd-large-value" id="vpdValue">1.25</div>
                    <div class="vpd-label">VPD (kPa)</div>
                </div>

                <div class="vpd-range">
                    <div>
                        <div class="range-label">Target</div>
                        <div class="range-value">1.2-1.3</div>
                    </div>
                    <div>
                        <div class="range-label">Current Status</div>
                        <div class="range-value" style="color: #00C310;">OPTIMAL</div>
                    </div>
                </div>

                <div class="vpd-gauge-simple">
                    <div class="gauge-fill"></div>
                    <div class="gauge-indicator" id="vpdIndicator" style="left: 60%;"></div>
                </div>

                <button class="adjust-button" onclick="adjustSetpoint()">Adjust Setpoint</button>
            </div>

            <div class="process-status-card">
                <div class="status-phase">
                    <div class="phase-header">
                        <div class="phase-name">Drying Phase</div>
                        <div class="phase-time">Complete</div>
                    </div>
                    <div class="phase-bar">
                        <div class="phase-fill complete">
                            <div class="phase-text">100% COMPLETE</div>
                        </div>
                    </div>
                </div>
                <div class="status-phase">
                    <div class="phase-header">
                        <div class="phase-name">Curing Phase</div>
                        <div class="phase-time">2d 6h remaining</div>
                    </div>
                    <div class="phase-bar">
                        <div class="phase-fill active" style="width: 45%;">
                            <div class="phase-text">45%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel">
            <div class="equipment-card">
                <div class="card-header">
                    <div class="card-title">Equipment Status</div>
                </div>
                <div class="equipment-grid">
                    <div class="equipment-item on" onclick="toggleEquipment(this, 'mini-split')">
                        <div class="equipment-name">Mini-Split</div>
                        <div class="equipment-status-text">ON</div>
                    </div>
                    <div class="equipment-item idle" onclick="toggleEquipment(this, 'dehumidifier')">
                        <div class="equipment-name">Dehumidifier</div>
                        <div class="equipment-status-text">IDLE</div>
                    </div>
                    <div class="equipment-item off" onclick="toggleEquipment(this, 'humidifier')">
                        <div class="equipment-name">Humidifier</div>
                        <div class="equipment-status-text">OFF</div>
                    </div>
                    <div class="equipment-item on" onclick="toggleEquipment(this, 'erv')">
                        <div class="equipment-name">ERV</div>
                        <div class="equipment-status-text">ON</div>
                    </div>
                    <div class="equipment-item on" onclick="toggleEquipment(this, 'supply-fan')">
                        <div class="equipment-name">Supply Fan</div>
                        <div class="equipment-status-text">60%</div>
                    </div>
                    <div class="equipment-item on" onclick="toggleEquipment(this, 'exhaust-fan')">
                        <div class="equipment-name">Exhaust Fan</div>
                        <div class="equipment-status-text">60%</div>
                    </div>
                </div>
            </div>

            <div class="sensor-card alerts-card">
                <div class="card-header">
                    <div class="card-title">Active Alerts</div>
                </div>
                <div class="alert-item">
                    <svg class="alert-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                    </svg>
                    <div class="alert-text">Zone 3 humidity approaching limit</div>
                    <div class="alert-time">2m</div>
                </div>
                <div class="alert-item" style="border-left-color: #FFA500;">
                    <svg class="alert-icon" viewBox="0 0 24 24" fill="#FFA500">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="12" stroke="white" stroke-width="2"/>
                        <line x1="12" y1="16" x2="12.01" y2="16" stroke="white" stroke-width="2"/>
                    </svg>
                    <div class="alert-text">Maintenance due in 48 hours</div>
                    <div class="alert-time">1h</div>
                </div>
            </div>

            <div class="sensor-card">
                <div class="card-header">
                    <div class="card-title">Quick Stats</div>
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-value">18.5h</div>
                        <div class="summary-label">Runtime Today</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">92%</div>
                        <div class="summary-label">Efficiency</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">3</div>
                        <div class="summary-label">Alerts (24h)</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">Good</div>
                        <div class="summary-label">Air Quality</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants
        const VPD_MIN = 0.6;
        const VPD_MAX = 2.0;
        const VPD_TARGET_MIN = 1.2;
        const VPD_TARGET_MAX = 1.3;
        let currentVPD = 1.25;

        // Update time
        function updateTime() {
            const now = new Date();
            const timeOptions = { hour: 'numeric', minute: '2-digit', hour12: true };
            const dateOptions = { month: 'short', day: 'numeric', year: 'numeric' };
            
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions).toUpperCase();
        }

        // Update VPD Display
        function updateVPDDisplay() {
            const vpdValue = document.getElementById('vpdValue');
            const vpdIndicator = document.getElementById('vpdIndicator');
            
            vpdValue.textContent = currentVPD.toFixed(2);
            
            // Update indicator position (0.6 to 2.0 kPa range)
            const position = ((currentVPD - VPD_MIN) / (VPD_MAX - VPD_MIN)) * 100;
            vpdIndicator.style.left = `${Math.max(0, Math.min(100, position))}%`;
            
            // Update color based on range
            if (currentVPD >= VPD_TARGET_MIN && currentVPD <= VPD_TARGET_MAX) {
                vpdValue.style.background = 'linear-gradient(135deg, #00C310, #00E515)';
                vpdValue.style.webkitBackgroundClip = 'text';
                vpdValue.style.webkitTextFillColor = 'transparent';
            } else if (currentVPD >= 1.0 && currentVPD <= 1.5) {
                vpdValue.style.background = 'linear-gradient(135deg, #FFA500, #FFD700)';
                vpdValue.style.webkitBackgroundClip = 'text';
                vpdValue.style.webkitTextFillColor = 'transparent';
            } else {
                vpdValue.style.background = 'linear-gradient(135deg, #8858ed, #6633bb)';
                vpdValue.style.webkitBackgroundClip = 'text';
                vpdValue.style.webkitTextFillColor = 'transparent';
            }
        }

        // Navigation functions
        function goHome() {
            console.log('Already on home page');
        }

        function openSettings() {
            window.location.href = './settings.html';
        }

        function openAnalytics() {
            window.location.href = './analytics.html';
        }

        function emergencyStop() {
            if (confirm('EMERGENCY STOP: This will halt all equipment immediately. Confirm?')) {
                console.log('Emergency stop activated');
                // Update all equipment to OFF
                document.querySelectorAll('.equipment-item').forEach(item => {
                    item.classList.remove('on', 'idle');
                    item.classList.add('off');
                    item.querySelector('.equipment-status-text').textContent = 'OFF';
                });
                
                // Call backend API
                fetch('http://localhost:8080/api/emergency-stop', { 
                    method: 'POST' 
                }).catch(err => console.error('Emergency stop API error:', err));
            }
        }

        // Adjust setpoint
        function adjustSetpoint() {
            const newSetpoint = prompt('Enter new VPD setpoint (kPa):', currentVPD.toFixed(2));
            if (newSetpoint && !isNaN(newSetpoint)) {
                const value = parseFloat(newSetpoint);
                if (value >= VPD_MIN && value <= VPD_MAX) {
                    // Send to backend API
                    fetch('/api/setpoint', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({vpd_target: value})
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Setpoint updated:', data);
                        currentVPD = value;
                        updateVPDDisplay();
                    })
                    .catch(error => {
                        console.error('Error updating setpoint:', error);
                        alert('Failed to update setpoint');
                    });
                } else {
                    alert(`VPD must be between ${VPD_MIN} and ${VPD_MAX} kPa`);
                }
            }
        }

        // Toggle equipment
        function toggleEquipment(element, equipment) {
            const states = ['on', 'idle', 'off'];
            let currentState = 'off';
            
            states.forEach(state => {
                if (element.classList.contains(state)) {
                    currentState = state;
                    element.classList.remove(state);
                }
            });
            
            const nextState = states[(states.indexOf(currentState) + 1) % states.length];
            element.classList.add(nextState);
            
            const statusText = element.querySelector('.equipment-status-text');
            if (equipment.includes('fan') && nextState === 'on') {
                statusText.textContent = '60%';
            } else {
                statusText.textContent = nextState.toUpperCase();
            }
        }

        // Replace the updateSensors function with this one that fetches real data
        function updateSensors() {
            // Fetch real sensor data from the API
            fetch('/api/sensors')
                .then(response => response.json())
                .then(data => {
                    // Update Zone 1 (dry_room_1)
                    if (data.dry_room_1) {
                        document.querySelector('[data-sensor="zone1-temp"]').innerHTML = 
                            Math.round(data.dry_room_1.temperature) + '<span class="sensor-unit">°F</span>';
                        document.querySelector('[data-sensor="zone1-humid"]').innerHTML = 
                            Math.round(data.dry_room_1.humidity) + '<span class="sensor-unit-humid">%</span>';
                    }
                    
                    // Update Supply (supply_duct)
                    if (data.supply_duct) {
                        document.querySelector('[data-sensor="supply"]').innerHTML = 
                            Math.round(data.supply_duct.temperature) + '<span class="sensor-unit">°F</span>';
                        document.querySelector('[data-sensor="supply-rh"]').innerHTML = 
                            Math.round(data.supply_duct.humidity) + '<span class="sensor-unit">%</span>';
                    }
                    
                    // Mark other zones as N/A since no sensors
                    document.querySelector('[data-sensor="zone2-temp"]').innerHTML = 'N/A';
                    document.querySelector('[data-sensor="zone2-humid"]').innerHTML = 'N/A';
                    document.querySelector('[data-sensor="zone3-temp"]').innerHTML = 'N/A';
                    document.querySelector('[data-sensor="zone3-humid"]').innerHTML = 'N/A';
                    document.querySelector('[data-sensor="zone4-temp"]').innerHTML = 'N/A';
                    document.querySelector('[data-sensor="zone4-humid"]').innerHTML = 'N/A';
                })
                .catch(error => console.error('Error fetching sensors:', error));
            
            // Fetch VPD status
            fetch('/api/status')
                .then(response => response.json())
                .then(data => {
                    if (data.vpd) {
                        currentVPD = data.vpd.current;
                        updateVPDDisplay();
                        
                        // Update mode and progress
                        document.getElementById('modeText').textContent = data.phase.name.toUpperCase();
                        document.getElementById('modeProgress').textContent = `Day ${data.phase.day} of ${data.phase.total_days}`;
                    }
                    
                    // Update equipment states
                    if (data.equipment) {
                        Object.entries(data.equipment).forEach(([name, state]) => {
                            // Map equipment names to UI elements
                            const equipMap = {
                                'dehumidifier': 'dehumidifier',
                                'humidifier': 'humidifier',
                                'erv': 'erv',
                                'supply_fan': 'supply-fan',
                                'return_fan': 'exhaust-fan'
                            };
                            
                            const equipEl = document.querySelector(`[onclick*="${equipMap[name]}"]`);
                            if (equipEl) {
                                equipEl.classList.remove('on', 'idle', 'off');
                                equipEl.classList.add(state.toLowerCase());
                                equipEl.querySelector('.equipment-status-text').textContent = state;
                            }
                        });
                    }
                })
                .catch(error => console.error('Error fetching status:', error));
        }

        // Update every 2 seconds to match your backend
        setInterval(updateSensors, 2000);

        // Touch/swipe handling for VPD adjustment
        let touchStartY = 0;
        let touchStartVPD = currentVPD;

        const vpdCard = document.querySelector('.vpd-main-card');
        
        vpdCard.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
            touchStartVPD = currentVPD;
        }, { passive: true });

        vpdCard.addEventListener('touchmove', (e) => {
            const deltaY = touchStartY - e.touches[0].clientY;
            const deltaVPD = (deltaY / 100) * 0.2; // Adjust sensitivity
            currentVPD = Math.max(VPD_MIN, Math.min(VPD_MAX, touchStartVPD + deltaVPD));
            updateVPDDisplay();
        }, { passive: true });

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (event) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Initialize
        updateTime();
        updateVPDDisplay();
        setInterval(updateTime, 60000);
        setInterval(updateSensors, 3000);
    </script>
</body>
</html>